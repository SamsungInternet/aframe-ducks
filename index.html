<html>
<head>
<script src="https://aframe.io/releases/0.5.0/aframe.min.js"></script>
<script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v1.16.0/dist/aframe-extras.min.js"></script>

<script>
  AFRAME.registerComponent('change-color-on-hover', {
    schema: {
      color: {default: 'red'}
    },
    init: function () {
      var data = this.data;
      var el = this.el;  // <a-box>
      var defaultColor = el.getAttribute('material').color;
      el.addEventListener('mouseenter', function () {
        el.setAttribute('color', data.color);
      });
      el.addEventListener('mouseleave', function () {
        el.setAttribute('color', defaultColor);
      });
    }
  });

  AFRAME.registerComponent('collison-check', {
    schema: {
      el: {
        type: 'selector'
      },
      radius: {
        default: 0
      },
      otherRadius: {
        default: 0
      }
    },
    tick: function () {
      var el1 = this.el;
      var el2 = this.data.el;
      var dist = el1.object3D.getWorldPosition().distanceTo(el2.object3D.getWorldPosition());
      if (dist < this.data.radius + this.data.otherRadius) {
        //this.el.emit('collide');
          //document.querySelector('#win-screen').emit('fade');
          //document.querySelector('#win-text').emit('fade');
        console.log("touch");
      }
    }
  });

/*
AFRAME.registerComponent('collison', {
scheme:{
  win:{
    default: false
  }
},
  init :function (){
    var sceneEl = document.querySelector('a-scene');
    var el = this.el;

      el.addEventListener('collide', function(){
      var boxEl = document.createElement('a-box');
      boxEl.setAttribute('material', {color: '#e1c7fc'});
      boxEl.setAttribute('position', {x:0, y:0, z:-3});
      boxEl.setAttribute('scale', {x:10, y:10, z:1});
        //attach fade animation?
      boxEl.setAttribute()

      sceneEl.appendChild(boxEl);

      var textEl = document.createElement('text');
      textEl.setAttribute('value', {value: "you did it"});
      sceneEl.appendChild(textEl);

    });
  }
});
*/
</script>
</head>

<body>
  <a-scene collison>

    <a-assets>
       <img id="skyTexture" src="background.png">
    </a-assets>

    <a-entity position= "1 0 -3">
      <a-box color="#fdfd96" scale = "0.1 0.1 .1"> </a-box>
      <a-animation attribute="rotation" to="0 -360 0" repeat="indefinite" fill="both" easing="linear" dur="30000" > </a-animation>
      <a-box color="#fdfd96" scale = "0.1 0.1 .1"  position="0 0 1">
        <a-animation attribute="rotation" to="0 360 0"  easing="linear" dur="4000" begin="mouseenter" > </a-animation>
        <a-box color="#fdfd96" position="20 0 -10" change-color-on-hover="color: white" scale = "2 3 3" collison-check="el: #ring; radius: 0.15; other-radius: 0.15;"> </a-box>
      </a-box>
    </a-entity>

    <a-entity position= "-1.2 0 -3.3">
      <a-box color="#9696fd" scale = "0.1 0.1 .1"> </a-box>
      <a-animation attribute="rotation" to="0 360 0" repeat="indefinite" fill="both" easing="linear" dur="40000" > </a-animation>
      <a-box color="#9696fd" scale = "0.1 0.1 .1"  position="0 0 1">
        <a-animation attribute="rotation" to="0 360 0"  easing="linear" fill="both" dur="4000" begin="mouseenter" > </a-animation>
        <a-box id="ring" color="#9696fd" position="0 0 -15" change-color-on-hover="color: white" scale = "3 3 2"></a-box>
      </a-box>
    </a-entity>

    <a-entity id="text" position="0 0.2 0.1" rotation="-45 0 0" text="width: 4; align: center; color: black; value: Make the ducks meet"></a-entity>

    <!--
    <a-entity id="win-screen" visible="false" material="opacity: .2" geometry="primitive: box" color="#e1c7fc" position="0 0 -3" scale="10 10 1" >
        <a-animation attribute="visible" begin="fade" to="true"></a-animation>
        <a-animation attribute="material.opacity" dur="4000" begin="fade" from ="0" to="1"></a-animation>
    </a-entity>

    <a-entity id="win-text" position="0 1.2 -2" text="width: 4; align: center; color: black; value: You did it" visible="false" material="opacity: .2">
      <a-animation attribute="visible" begin="fade" to="true"></a-animation>
      <a-animation attribute="material.opacity" dur="4000"  begin="fade" from ="0" to="1"></a-animation>
    </a-entity>
  -->

    <a-plane position="0 -0.1 0" rotation="-90 0 0" width="50" height="50" color="#7BC8A4"></a-plane>
    <!--
 <a-entity rotation="90 0 0" position="0 -2.5 0" scale="50 50" geometry="primitive: plane" material="color: #000; side: double; opacity: 0.5">
    </a-entity>
  -->

    <a-entity scale="1 1 1"><a-ocean scale="1.5 1.2 0.2" material="color: #000000" position="0 0 -5" density="20" opacity="0.8" speed="0.1"></a-ocean> </a-entity>

    <a-camera position="0 0.2 1.3"><a-cursor></a-cursor></a-camera>

    <a-sky id="background" src="#skyTexture" theta-length="91" radius="30"></a-sky>

  </a-scene>
</body>
</html>
